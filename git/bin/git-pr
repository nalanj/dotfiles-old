#!/bin/bash

# Creates a new PR branch and adds the given rev to it

set -e

if [[ "$#" -ne 2 ]]; then
    echo "Usage: git pr [name] [rev]"
    exit
fi

name="pr/$1"
rev=$2

orig_head=$(git rev-parse --abbrev-ref HEAD)
changes=$(git status -s | wc -l)

if [[ $changes -gt 0 ]]; then
  echo "You have pending changes"
  exit
fi

echo "* Creating PR branch $name"
git branch $name origin/master --no-track
#git branch -q --set-upstream-to origin/$1 $name

git-pr-add $1 $2

